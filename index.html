<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Performance, Forms, Commitments</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ... (all your v23/v21 CSS as before) ... */
  </style>
  <script src="hierarchy.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
  <h1>Weekly Business Review</h1>

  <!-- Selection Page -->
  <div id="selectionSection">
    <!-- ... as before ... -->
  </div>

  <!-- Data Entry Page -->
  <div id="metricsSection" class="hidden">
    <!-- ... as before ... -->
  </div>

  <!-- Data Table Page -->
  <div id="tableSection" class="hidden">
    <div id="printMeta"></div>
    <h2 id="tableTitle"></h2>
    <table>
      <thead>
        <tr class="header-row">
          <th>Metric</th>
          <th>Week 1</th>
          <th>Week 2</th>
          <th>Week 3</th>
          <th>Week 4</th>
          <th>Week 5</th>
        </tr>
      </thead>
      <tbody id="metricsTable"></tbody>
    </table>
    <div class="actions" id="tableActions">
      <button id="backToMetrics">Back</button>
      <button id="clearAllData">Clear All Data</button>
      <button id="printTableBtn" type="button">Print</button>
    </div>
  </div>

  <script>
    // ... (all your other JS as before) ...

    // Print screenshot of current tableSection, centered on page
    printTableBtn.onclick = function() {
      html2canvas(tableSection).then(function(canvas) {
        // Open a new window for the printout
        let win = window.open('', '_blank');
        win.document.write(`
          <html>
          <head>
            <title>Print Table</title>
            <style>
              body {
                margin: 0;
                background: #fff;
                width: 100vw;
                height: 100vh;
              }
              .centered-print {
                display: flex;
                align-items: center;
                justify-content: center;
                height: 100vh;
                width: 100vw;
                box-sizing: border-box;
              }
              canvas {
                max-width: 90vw;
                max-height: 90vh;
                display: block;
                margin: auto;
                background: #fff;
              }
            </style>
          </head>
          <body>
            <div class="centered-print" id="canvasContainer"></div>
          </body>
          </html>
        `);
        // Wait for document to be ready before appending canvas
        win.document.close();
        win.onload = function() {
          win.document.getElementById('canvasContainer').appendChild(canvas);
          setTimeout(() => {
            win.print();
          }, 400);
        };
      });
    };

    // ... (rest of JS as before) ...
  </script>
</body>
</html>
